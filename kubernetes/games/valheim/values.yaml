---
app-template:
  image:
    repository: mbround18/valheim
    tag: latest
  env:
    - name: NAME
      valueFrom:
        secretKeyRef:
          name: valheim-secret
          key: SERVER_NAME
    - name: WORLD
      valueFrom:
        secretKeyRef:
          name: valheim-secret
          key: WORLD_NAME
    - name: PASSWORD
      valueFrom:
        secretKeyRef:
          name: valheim-secret
          key: SERVER_PASS
    # - name: WEBHOOK_URL
    #  valueFrom:
    #    secretKeyRef:
    #      name: valheim-secret
    #      key: DISCORD_WEBHOOK
    # - name: BACKUPS
    #   value: true
    - name: PUBLIC
      value: false
    - name: TZ
      value: "Europe/Berlin"
    - name: PORT
      value: 2456
    # - name: AUTO_UPDATE
    #   value: true
    # - name: AUTO_UPDATE_PAUSE_WITH_PLAYERS
    #   value: true
  probes:
    liveness:
      enabled: false
      spec:
        initialDelaySeconds: 10
        periodSeconds: 10
        timeoutSeconds: 1
        failureThreshold: 5
  persistence:
    # backups:
    #   enabled: true
    #   type: nfs
    #   server: 192.168.30.4
    #   path: /mnt/HDD/Backups/valheim
    #   mountPath: /home/steam/backups
    config:
      enabled: true
      existingClaim: valheim-config
      mountPath: /home/steam/.config/unity3d/IronGate/Valheim
    server:
      enabled: true
      existingClaim: valheim-server
      mountPath: /home/steam/valheim
  service:
    main:
      type: LoadBalancer
      externalTrafficPolicy: Local
      loadBalancerIP: 192.168.40.4
      ports:
        http:
          enabled: false
        valheim-1:
          enabled: true
          port: 2456
          protocol: UDP
          targetPort: 2456
        valheim-2:
          enabled: false
          port: 2457
          protocol: UDP
          targetPort: 2457
        valheim-3:
          enabled: false
          port: 2458
          protocol: UDP
          targetPort: 2458
  ingress:
    main:
      enabled: true
      ingressClassName: traefik
      annotations:
        hajimari.io/enable: "true"
        hajimari.io/icon: bell-outline
  # nodeSelector:
  #   intel.feature.node.kubernetes.io/gpu: "true"
  # resources:
  #   limits:
  #     gpu.intel.com/i915: 1
  #     memory: "7Gi"
  #   requests:
  #     gpu.intel.com/i915: 1
  #     memory: "5Gi"
